{% extends "base.html" %}

{% block title %}Configurações - AutoSub{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row">
        <!-- Menu Lateral -->
        <div class="col-md-3">
            <div class="card sticky-top" style="top: 20px;">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fas fa-cog me-2"></i>Configurações</h5>
                </div>
                <div class="list-group list-group-flush">
                    <a href="#geral" class="list-group-item list-group-item-action active" onclick="showSection('geral', this)">
                        <i class="fas fa-sliders-h me-2"></i>Geral
                    </a>
                    <a href="#api-services" class="list-group-item list-group-item-action" onclick="showSection('api-services', this)">
                        <i class="fas fa-key me-2"></i>Serviços de API
                    </a>
                    <a href="#prompts" class="list-group-item list-group-item-action" onclick="showSection('prompts', this)">
                        <i class="fas fa-comment-dots me-2"></i>Prompts
                    </a>
                    <a href="#modelos" class="list-group-item list-group-item-action" onclick="showSection('modelos', this)">
                        <i class="fas fa-brain me-2"></i>Modelos
                    </a>
                    <a href="#overlay" class="list-group-item list-group-item-action" onclick="showSection('overlay', this)">
                        <i class="fas fa-layer-group me-2"></i>Overlay
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Conteúdo Principal -->
        <div class="col-md-9">
            <h2><i class="fas fa-cog"></i> Configurações do Sistema</h2>
            <p class="text-muted">Gerencie as configurações globais do AutoSub.</p>
            
            <form method="POST" action="{{ url_for('save_settings') }}" enctype="multipart/form-data">
                
                <!-- Seção: Geral -->
                <div id="section-geral" class="config-section">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="fas fa-sliders-h me-2"></i>Configurações Gerais</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="transcription_service" class="form-label">Serviço de Transcrição</label>
                                <select class="form-select" id="transcription_service" name="transcription_service" required>
                                    <option value="autosub" {% if settings.general.get('transcription_service') == 'autosub' %}selected{% endif %}>
                                        AutoSub (Local)
                                    </option>
                                    <option value="openai_whisper" {% if settings.general.get('transcription_service') == 'openai_whisper' %}selected{% endif %}>
                                        OpenAI Whisper (API)
                                    </option>
                                </select>
                                <div class="form-text">
                                    Escolha qual serviço será usado para fazer a transcrição dos áudios.
                                    <br><strong>AutoSub:</strong> Processamento local (gratuito)
                                    <br><strong>OpenAI Whisper:</strong> Maior precisão (requer API Key)
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Seção: Serviços de API -->
                <div id="section-api-services" class="config-section" style="display: none;">
                    <div class="card">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0"><i class="fas fa-key me-2"></i>Serviços de API</h5>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle"></i>
                                <strong>Importante:</strong> Essas são as chaves para consumir APIs externas (Google, OpenAI). 
                                Não confundir com as chaves de acesso à nossa API REST.
                            </div>
                            
                            <div class="mb-3">
                                <label for="google_translate_api_key" class="form-label">Chave da API do Google Translate</label>
                                <div class="input-group">
                                    <input type="password" class="form-control" id="google_translate_api_key" 
                                           name="google_translate_api_key" value="{{ settings.api_service.get('google_translate_api_key', '') }}"
                                           placeholder="Insira sua chave da API do Google Translate">
                                    <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('google_translate_api_key')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                                <div class="form-text">
                                    Necessária para tradução automática de legendas.
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="openai_api_key" class="form-label">Chave da API da OpenAI</label>
                                <div class="input-group">
                                    <input type="password" class="form-control" id="openai_api_key" 
                                           name="openai_api_key" value="{{ settings.api_service.get('openai_api_key', '') }}"
                                           placeholder="Insira sua chave da API da OpenAI">
                                    <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('openai_api_key')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                                <div class="form-text">
                                    Necessária para correção de legendas e geração de conteúdo para redes sociais.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Seção: Prompts -->
                <div id="section-prompts" class="config-section" style="display: none;">
                    <div class="card">
                        <div class="card-header bg-warning text-dark">
                            <h5 class="mb-0"><i class="fas fa-comment-dots me-2"></i>Prompts para Redes Sociais</h5>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle"></i>
                                <strong>Dica:</strong> Use variáveis como {transcricao} para inserir o texto transcrito nos prompts.
                            </div>
                            
                            <div class="mb-3">
                                <label for="instagram_prompt" class="form-label">Prompt para Instagram</label>
                                <textarea class="form-control" id="instagram_prompt" name="instagram_prompt" 
                                          rows="4" required>{{ settings.prompts.get('instagram_prompt', '') }}</textarea>
                                <div class="form-text">
                                    Prompt usado para gerar legendas para Instagram baseadas na transcrição.
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="tiktok_prompt" class="form-label">Prompt para TikTok</label>
                                <textarea class="form-control" id="tiktok_prompt" name="tiktok_prompt" 
                                          rows="4" required>{{ settings.prompts.get('tiktok_prompt', '') }}</textarea>
                                <div class="form-text">
                                    Prompt usado para gerar legendas para TikTok baseadas na transcrição.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Seção: Modelos -->
                <div id="section-modelos" class="config-section" style="display: none;">
                    <div class="card">
                        <div class="card-header bg-info text-white">
                            <h5 class="mb-0"><i class="fas fa-brain me-2"></i>Modelos de IA</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="openai_model_transcription" class="form-label">Modelo OpenAI para Transcrição</label>
                                <select class="form-select" id="openai_model_transcription" name="openai_model_transcription" required>
                                    <option value="whisper-1" {% if settings.models.get('openai_model_transcription') == 'whisper-1' %}selected{% endif %}>
                                        whisper-1 (Único disponível)
                                    </option>
                                </select>
                                <div class="form-text">
                                    Modelo usado para transcrição quando OpenAI Whisper estiver selecionado.
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="openai_model_text" class="form-label">Modelo OpenAI para Geração de Texto</label>
                                <select class="form-select" id="openai_model_text" name="openai_model_text" required>
                                    <option value="gpt-4o-mini" {% if settings.models.get('openai_model_text') == 'gpt-4o-mini' %}selected{% endif %}>
                                        gpt-4o-mini (Recomendado - Rápido e Econômico)
                                    </option>
                                    <option value="gpt-4o" {% if settings.models.get('openai_model_text') == 'gpt-4o' %}selected{% endif %}>
                                        gpt-4o (Mais Preciso)
                                    </option>
                                    <option value="gpt-4.1" {% if settings.models.get('openai_model_text') == 'gpt-4.1' %}selected{% endif %}>
                                        gpt-4.1 (Nova Geração)
                                    </option>
                                    <option value="gpt-4.1-mini" {% if settings.models.get('openai_model_text') == 'gpt-4.1-mini' %}selected{% endif %}>
                                        gpt-4.1-mini (Nova Geração Econômica)
                                    </option>
                                    <option value="o3" {% if settings.models.get('openai_model_text') == 'o3' %}selected{% endif %}>
                                        o3 (Mais Avançado - Mais Caro)
                                    </option>
                                    <option value="gpt-3.5-turbo" {% if settings.models.get('openai_model_text') == 'gpt-3.5-turbo' %}selected{% endif %}>
                                        gpt-3.5-turbo (Básico)
                                    </option>
                                </select>
                                <div class="form-text">
                                    Modelo usado para correção de legendas e geração de conteúdo para redes sociais.
                                </div>
                            </div>
                            
                            <div class="alert alert-warning">
                                <i class="fas fa-exclamation-triangle"></i>
                                <strong>Custo por Token:</strong>
                                <ul class="mb-0 mt-2">
                                    <li><strong>gpt-4o-mini:</strong> Mais barato (ideal para uso intenso)</li>
                                    <li><strong>gpt-4o:</strong> Custo médio (melhor qualidade)</li>
                                    <li><strong>gpt-4.1/4.1-mini:</strong> Nova geração (variável)</li>
                                    <li><strong>o3:</strong> Mais caro (máxima qualidade)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Seção: Overlay -->
                <div id="section-overlay" class="config-section" style="display: none;">
                    <div class="card">
                        <div class="card-header bg-secondary text-white">
                            <h5 class="mb-0"><i class="fas fa-layer-group me-2"></i>Configurações de Overlay</h5>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle"></i>
                                <strong>Overlay:</strong> Configurações de elementos sobrepostos nos vídeos (logo e legendas).
                            </div>
                            
                            <!-- Configurações do Logo -->
                            <div class="card mb-4">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0"><i class="fas fa-image me-2"></i>Logo da Empresa</h6>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label for="logo_file" class="form-label">Upload do Logo</label>
                                        <input type="file" class="form-control" id="logo_file" name="logo_file" 
                                               accept="image/*" onchange="previewLogo(this)">
                                        <div class="form-text">
                                            Formatos aceitos: PNG, JPG, JPEG, SVG. Recomendado: PNG com fundo transparente.
                                        </div>
                                        
                                        <!-- Preview do logo atual -->
                                        {% if settings.video.get('logo_path') %}
                                        <div class="mt-3" id="current-logo">
                                            <label class="form-label">Logo Atual:</label>
                                            <div class="d-flex align-items-center">
                                                <img src="{{ url_for('static', filename='uploads/logos/' + settings.video.get('logo_filename', '')) }}" 
                                                     alt="Logo atual" class="img-thumbnail me-3" style="max-width: 100px; max-height: 100px;">
                                                <div>
                                                    <small class="text-muted">{{ settings.video.get('logo_filename', '') }}</small><br>
                                                    <button type="button" class="btn btn-sm btn-outline-danger mt-1" onclick="removeLogo()">
                                                        <i class="fas fa-trash me-1"></i>Remover Logo
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        {% endif %}
                                        
                                        <!-- Preview do novo logo -->
                                        <div class="mt-3" id="logo-preview" style="display: none;">
                                            <label class="form-label">Preview:</label>
                                            <div>
                                                <img id="preview-img" src="" alt="Preview do logo" 
                                                     class="img-thumbnail" style="max-width: 150px; max-height: 150px;">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="logo_position" class="form-label">Posição do Logo</label>
                                                <select class="form-select" id="logo_position" name="logo_position">
                                                    <option value="top-left" {% if settings.video.get('logo_position') == 'top-left' %}selected{% endif %}>
                                                        Superior Esquerda
                                                    </option>
                                                    <option value="top-right" {% if settings.video.get('logo_position') == 'top-right' %}selected{% endif %}>
                                                        Superior Direita
                                                    </option>
                                                    <option value="bottom-left" {% if settings.video.get('logo_position') == 'bottom-left' %}selected{% endif %}>
                                                        Inferior Esquerda
                                                    </option>
                                                    <option value="bottom-right" {% if settings.video.get('logo_position') == 'bottom-right' %}selected{% endif %}>
                                                        Inferior Direita
                                                    </option>
                                                    <option value="center" {% if settings.video.get('logo_position') == 'center' %}selected{% endif %}>
                                                        Centro
                                                    </option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="logo_size" class="form-label">Tamanho (%)</label>
                                                <input type="number" class="form-control" id="logo_size" name="logo_size" 
                                                       value="{{ settings.video.get('logo_size', '25') }}" min="1" max="100">
                                                <div class="form-text">% da largura do vídeo</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="logo_opacity" class="form-label">Opacidade (%)</label>
                                        <input type="number" class="form-control" id="logo_opacity" name="logo_opacity" 
                                               value="{{ settings.video.get('logo_opacity', '80') }}" min="10" max="100">
                                        <div class="form-text">Transparência do logo (10-100%)</div>
                                    </div>
                                    
                                    <input type="hidden" id="remove_logo" name="remove_logo" value="false">
                                </div>
                            </div>
                            
                            <!-- Configurações das Legendas -->
                            <div class="card">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0"><i class="fas fa-closed-captioning me-2"></i>Configurações de Legendas</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="subtitle_font_size" class="form-label">Tamanho da Fonte</label>
                                                <input type="number" class="form-control" id="subtitle_font_size" name="subtitle_font_size" 
                                                       value="{{ settings.subtitles.get('subtitle_font_size', '20') }}" min="10" max="40">
                                                <div class="form-text">Tamanho da fonte (10-40px)</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="subtitle_font_family" class="form-label">Família da Fonte</label>
                                                <select class="form-select" id="subtitle_font_family" name="subtitle_font_family">
                                                    <option value="Arial" {% if settings.subtitles.get('subtitle_font_family') == 'Arial' %}selected{% endif %}>Arial</option>
                                                    <option value="Helvetica" {% if settings.subtitles.get('subtitle_font_family') == 'Helvetica' %}selected{% endif %}>Helvetica</option>
                                                    <option value="Times" {% if settings.subtitles.get('subtitle_font_family') == 'Times' %}selected{% endif %}>Times New Roman</option>
                                                    <option value="Verdana" {% if settings.subtitles.get('subtitle_font_family') == 'Verdana' %}selected{% endif %}>Verdana</option>
                                                    <option value="Impact" {% if settings.subtitles.get('subtitle_font_family') == 'Impact' %}selected{% endif %}>Impact</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="subtitle_font_color" class="form-label">Cor da Fonte</label>
                                                <div class="input-group">
                                                    <input type="color" class="form-control form-control-color" id="subtitle_font_color" 
                                                           name="subtitle_font_color" value="{{ settings.subtitles.get('subtitle_font_color', '#FFFFFF') }}">
                                                    <input type="text" class="form-control" value="{{ settings.subtitles.get('subtitle_font_color', '#FFFFFF') }}" 
                                                           onchange="document.getElementById('subtitle_font_color').value = this.value">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="subtitle_outline_color" class="form-label">Cor do Contorno</label>
                                                <div class="input-group">
                                                    <input type="color" class="form-control form-control-color" id="subtitle_outline_color" 
                                                           name="subtitle_outline_color" value="{{ settings.subtitles.get('subtitle_outline_color', '#000000') }}">
                                                    <input type="text" class="form-control" value="{{ settings.subtitles.get('subtitle_outline_color', '#000000') }}" 
                                                           onchange="document.getElementById('subtitle_outline_color').value = this.value">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="subtitle_background_color" class="form-label">Cor de Fundo</label>
                                                <div class="input-group">
                                                    <input type="color" class="form-control form-control-color" id="subtitle_background_color" 
                                                           name="subtitle_background_color" value="{{ settings.subtitles.get('subtitle_background_color', '#000000') }}">
                                                    <input type="text" class="form-control" value="{{ settings.subtitles.get('subtitle_background_color', '#000000') }}" 
                                                           onchange="document.getElementById('subtitle_background_color').value = this.value">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="subtitle_background_opacity" class="form-label">Opacidade do Fundo (%)</label>
                                                <input type="number" class="form-control" id="subtitle_background_opacity" name="subtitle_background_opacity" 
                                                       value="{{ settings.subtitles.get('subtitle_background_opacity', '70') }}" min="0" max="100">
                                                <div class="form-text">0=transparente, 100=opaco</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="subtitle_outline_width" class="form-label">Largura do Contorno</label>
                                                <input type="number" class="form-control" id="subtitle_outline_width" name="subtitle_outline_width" 
                                                       value="{{ settings.subtitles.get('subtitle_outline_width', '1') }}" min="0" max="3">
                                                <div class="form-text">Espessura do contorno (0-3px)</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="subtitle_position" class="form-label">Posição das Legendas</label>
                                                <select class="form-select" id="subtitle_position" name="subtitle_position" onchange="updateSubtitleHeightDefaults()">
                                                    <option value="top-left" {% if settings.subtitles.get('subtitle_position') == 'top-left' %}selected{% endif %}>Superior Esquerda</option>
                                                    <option value="top-center" {% if settings.subtitles.get('subtitle_position') == 'top-center' %}selected{% endif %}>Superior Centro</option>
                                                    <option value="top-right" {% if settings.subtitles.get('subtitle_position') == 'top-right' %}selected{% endif %}>Superior Direita</option>
                                                    <option value="bottom-left" {% if settings.subtitles.get('subtitle_position') == 'bottom-left' %}selected{% endif %}>Inferior Esquerda</option>
                                                    <option value="bottom-center" {% if settings.subtitles.get('subtitle_position') == 'bottom-center' %}selected{% endif %}>Inferior Centro</option>
                                                    <option value="bottom-right" {% if settings.subtitles.get('subtitle_position') == 'bottom-right' %}selected{% endif %}>Inferior Direita</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="subtitle_height_offset" class="form-label">Altura da Legenda (px)</label>
                                                <input type="number" class="form-control" id="subtitle_height_offset" name="subtitle_height_offset" 
                                                       value="{{ settings.subtitles.get('subtitle_height_offset', '80') }}" min="10" max="500">
                                                <div class="form-text">Distância da borda (superior ou inferior)</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Valores Recomendados</label>
                                                <div class="d-flex gap-1 flex-wrap">
                                                    <button type="button" class="btn btn-outline-info btn-sm" onclick="setSubtitleDefaults('top')">
                                                        Superior (30px)
                                                    </button>
                                                    <button type="button" class="btn btn-outline-info btn-sm" onclick="setSubtitleDefaults('bottom')">
                                                        Inferior (80px)
                                                    </button>
                                                    <button type="button" class="btn btn-outline-info btn-sm" onclick="setSubtitleDefaults('social')">
                                                        Redes Sociais (120px)
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="alert alert-success mt-3">
                                        <i class="fas fa-mobile-alt"></i>
                                        <strong>Otimização para Redes Sociais:</strong> 
                                        O sistema ajusta automaticamente as margens para evitar sobreposição com elementos do TikTok/Reels.
                                    </div>
                                    
                                    <!-- Preview das Configurações -->
                                    <div class="card mt-3">
                                        <div class="card-header bg-light">
                                            <h6 class="mb-0">Preview das Legendas</h6>
                                        </div>
                                        <div class="card-body text-center" style="background: #f8f9fa; min-height: 100px; display: flex; align-items: center; justify-content: center;">
                                            <div id="subtitle-preview" class="subtitle-preview-box">
                                                Exemplo de legenda
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Botões -->
                <div class="d-flex justify-content-between mt-4">
                    <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">
                        <i class="fas fa-arrow-left me-2"></i>Voltar
                    </a>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save me-2"></i>Salvar Configurações
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
.config-section {
    margin-bottom: 20px;
}

.list-group-item-action:hover {
    background-color: #f8f9fa;
}

.list-group-item-action.active {
    background-color: #0d6efd;
    border-color: #0d6efd;
    color: white;
}

.subtitle-preview-box {
    background: #000000b3;
    color: #FFFFFF;
    padding: 8px 16px;
    border-radius: 4px;
    display: inline-block;
    border: 1px solid #000000;
    font-family: Arial;
    font-size: 16px;
}

@media (max-width: 768px) {
    .col-md-3 {
        margin-bottom: 20px;
    }
    
    .sticky-top {
        position: relative !important;
    }
}
</style>

<script>
function showSection(sectionId, element) {
    // Esconder todas as seções
    const sections = document.querySelectorAll('.config-section');
    sections.forEach(section => {
        section.style.display = 'none';
    });
    
    // Mostrar seção selecionada
    document.getElementById('section-' + sectionId).style.display = 'block';
    
    // Atualizar menu lateral
    const menuItems = document.querySelectorAll('.list-group-item-action');
    menuItems.forEach(item => {
        item.classList.remove('active');
    });
    element.classList.add('active');
    
    // Scroll para o topo
    window.scrollTo(0, 0);
}

function togglePassword(fieldId) {
    const field = document.getElementById(fieldId);
    const button = field.nextElementSibling;
    const icon = button.querySelector('i');
    
    if (field.type === 'password') {
        field.type = 'text';
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
    } else {
        field.type = 'password';
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
    }
}

function previewLogo(input) {
    const preview = document.getElementById('logo-preview');
    const previewImg = document.getElementById('preview-img');
    
    if (input.files && input.files[0]) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
            previewImg.src = e.target.result;
            preview.style.display = 'block';
        };
        
        reader.readAsDataURL(input.files[0]);
    } else {
        preview.style.display = 'none';
    }
}

function removeLogo() {
    if (confirm('Tem certeza que deseja remover o logo atual?')) {
        document.getElementById('remove_logo').value = 'true';
        document.getElementById('current-logo').style.display = 'none';
        
        // Limpar input de arquivo
        document.getElementById('logo_file').value = '';
        document.getElementById('logo-preview').style.display = 'none';
        
        // Mostrar mensagem
        showToast('Logo será removido ao salvar as configurações.');
    }
}

// Valores padrão hardcoded para altura das legendas
const subtitleHeightDefaults = {
    'top-left': 30,
    'top-center': 30,
    'top-right': 30,
    'bottom-left': 80,
    'bottom-center': 80,
    'bottom-right': 80
};

function updateSubtitleHeightDefaults() {
    const position = document.getElementById('subtitle_position').value;
    const heightInput = document.getElementById('subtitle_height_offset');
    
    if (subtitleHeightDefaults[position]) {
        heightInput.value = subtitleHeightDefaults[position];
        showToast(`Altura ajustada para ${subtitleHeightDefaults[position]}px (padrão para ${getPositionName(position)})`);
    }
}

function setSubtitleDefaults(type) {
    const heightInput = document.getElementById('subtitle_height_offset');
    
    switch(type) {
        case 'top':
            heightInput.value = 30;
            showToast('Altura definida para 30px (ideal para posições superiores)');
            break;
        case 'bottom':
            heightInput.value = 80;
            showToast('Altura definida para 80px (ideal para posições inferiores)');
            break;
        case 'social':
            heightInput.value = 120;
            showToast('Altura definida para 120px (ideal para TikTok/Reels, evita sobreposição)');
            break;
    }
}

function getPositionName(position) {
    const names = {
        'top-left': 'Superior Esquerda',
        'top-center': 'Superior Centro', 
        'top-right': 'Superior Direita',
        'bottom-left': 'Inferior Esquerda',
        'bottom-center': 'Inferior Centro',
        'bottom-right': 'Inferior Direita'
    };
    return names[position] || position;
}

function showToast(message) {
    // Criar toast temporário
    const toast = document.createElement('div');
    toast.className = 'alert alert-info alert-dismissible fade show position-fixed';
    toast.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
    toast.innerHTML = `
        <i class="fas fa-info-circle"></i> ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    
    document.body.appendChild(toast);
    
    // Remover após 3 segundos
    setTimeout(() => {
        if (toast.parentNode) {
            toast.parentNode.removeChild(toast);
        }
    }, 3000);
}

// Inicialização - mostrar primeira seção
document.addEventListener('DOMContentLoaded', function() {
    showSection('geral', document.querySelector('.list-group-item-action.active'));
});
</script>
{% endblock %} 